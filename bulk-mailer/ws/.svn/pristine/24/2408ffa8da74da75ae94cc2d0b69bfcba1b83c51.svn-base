package beeriprint.newsletter.camel.processors;

import java.util.HashMap;
import java.util.Map;
import org.apache.camel.Exchange;
import org.apache.camel.Processor;

/**
 *
 * @author hilel
 */
public class PrepareUpdateEmail implements Processor {

    final String sql
            = "UPDATE email SET action_code  = :?actionCode, status_code = :?statusCode, diagnostic_code = :?diagnosticCode "
            + "WHERE id = :?messageCode";

    @Override
    public void process(Exchange exchange) throws Exception {
        Map results = exchange.getIn().getBody(HashMap.class);
        exchange.getOut().setHeader("CamelJdbcParameters", results);
        exchange.getOut().setBody(sql);
    }

}
