package beeriprint.newsletter.batch.mailer.processors;

import beeriprint.newsletter.batch.mailer.model.EmailRecord;
import javax.mail.internet.MimeMessage;
import org.springframework.batch.item.ItemProcessor;

/**
 *
 * @author Hilel Y.
 */
public class MimeToRecordTransformer implements ItemProcessor<MimeMessage, EmailRecord> {

    @Override
    public EmailRecord process(MimeMessage message) throws Exception {
        EmailRecord record = new EmailRecord();
        record.setCampaignDate(message.getHeader("X-campaignDate", null));
        record.setId(message.getHeader("X-recordId", null));
        record.setRecipientAddress(message.getHeader("X-recipientAddress", null));
        record.setRecipientName(message.getHeader("X-recipientName", null));
        record.setCreationTime(EmailRecord.DATE_FORMAT.parse(message.getHeader("X-creationTime", null)));
        return record;
    }
}
