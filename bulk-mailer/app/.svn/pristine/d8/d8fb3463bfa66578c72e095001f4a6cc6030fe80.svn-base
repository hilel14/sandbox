package beeriprint.newsletter.batch.mailer.disabled;

import com.sun.mail.smtp.SMTPMessage;
import java.io.FileInputStream;
import javax.mail.internet.MimeMessage;
import org.springframework.batch.item.ItemProcessor;
import org.springframework.core.io.Resource;

/**
 *
 * @author Hilel Y.
 */
public class ResourceToMimeTransformer implements ItemProcessor<Resource, MimeMessage> {

    @Override
    public MimeMessage process(Resource item) throws Exception {
        try (FileInputStream inputStream = new FileInputStream(item.getFile())) {
            SMTPMessage message = new SMTPMessage(null, inputStream);
            message.setReturnOption(SMTPMessage.RETURN_HDRS);
            message.setNotifyOptions(SMTPMessage.NOTIFY_DELAY | SMTPMessage.NOTIFY_FAILURE | SMTPMessage.NOTIFY_SUCCESS);
            return message;
        }
    }
}
